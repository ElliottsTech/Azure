{
    "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
    "handler": "Microsoft.Azure.CreateUIDef",
    "version": "0.1.2-preview",
    "parameters": {
        "config": {
            "isWizard": false,
            "basics": {
                "description": "**Microsoft Sentinel All-In-One** deployment, see more information about this project [here](https://github.com/Azure/Azure-Sentinel/Tools/Sentinel-All-In-One/).",
                "location": {
                    "label": "Location",
                    "toolTip": "Location for all resources",
                    "resourceTypes": [
                        "Microsoft.OperationalInsights/workspaces"
                    ]
                }
            }
        },
        "basics": [
            {
                "name": "rgName",
                "type": "Microsoft.Common.TextBox",
                "label": "Resource Group name",
                "placeholder": "",
                "defaultValue": "",
                "toolTip": "Enter a resource group name",
                "constraints": {
                    "required": true,
                    "regex": "^[A-Za-z0-9][A-Za-z0-9-]+[A-Za-z0-9]$",
                    "validationMessage": "Only alphanumeric characters are allowed, and the value must be 1-30 characters long."
                },
                "visible": true  
            },
            {
                "name": "workspaceName",
                "type": "Microsoft.Common.TextBox",
                "label": "Workspace Name",
                "placeholder": "",
                "defaultValue": "",
                "toolTip": "The Workspace name should include 4-63 letters, digits or '-'. The '-' shouldn't be the first or the last symbol.",
                "constraints": {
                    "required": true,
                    "regex": "^[A-Za-z0-9][A-Za-z0-9-]+[A-Za-z0-9]$",
                    "validationMessage": "Only alphanumeric characters are allowed, and the value must be 1-30 characters long."
                },
                "visible": true
            },
            {
                "name": "dailyQuota",
                "type": "Microsoft.Common.TextBox",
                "label": "Daily ingestion limit in GBs. Enter 0 for no limit.",
                "placeholder": "",
                "defaultValue": "0",
                "toolTip": "This limit doesn't apply to the following tables: SecurityAlert, SecurityBaseline, SecurityBaselineSummary, SecurityDetection, SecurityEvent, WindowsFirewall, MaliciousIPCommunication, LinuxAuditLog, SysmonEvent, ProtectionStatus, WindowsEvent. [Learn more](https://learn.microsoft.com/azure/azure-monitor/logs/daily-cap)",
                "constraints": {
                    "required": true,
                    "regex": "^[0-9]{1,4}$",
                    "validationMessage": "Only numbers allowed, and the value must be 1-4 characters long."
                },
                "visible": true
            },
            {
                "name": "dataRetention",
                "type": "Microsoft.Common.TextBox",
                "label": "Number of days of retention",
                "placeholder": "",
                "defaultValue": "90",
                "toolTip": "Only numbers allowed",
                "constraints": {
                    "required": true,
                    "regex": "([3-8][0-9]|9[0-9]|[1-6][0-9]{2}|7[0-2][0-9]|730)",
                    "validationMessage": "Retention must be between 30 and 730 days."
                },
                "visible": true
            },
            {
                "name": "pricingTier",
                "type": "Microsoft.Common.DropDown",
                "label": "Select pricing tier for Sentinel and Log Analytics",
                "placeholder": "",
                "multiselect": false,
                "toolTip": "Visit [Azure Monitor Pricing page](https://azure.microsoft.com/pricing/details/monitor/) for more information.",
                "defaultValue": [{"value": "PerGB2018"}],
                "constraints": {
                    "allowedValues": [
                        {
                            "label": "Pay-as-you-go",
                            "value": "PerGB2018"
                        },
                        {
                            "label": "Commitment Tier",
                            "value": "CapacityReservation"
                        }
                    ],
                    "required": true
                },
                "visible": true
            },
            {
                "name": "capacityReservation",
                "type": "Microsoft.Common.DropDown",
                "label": "Select Commitment Tier for Sentinel and Log Analytics",
                "placeholder": "",
                "multiselect": false,
                "defaultValue": 100,
                "toolTip": "Select the Commitment Tier in GB/day",
                "constraints": {
                    "allowedValues": [
                        {
                            "label": "100 GB",
                            "value": 100
                        },
                        {
                            "label": "200 GB",
                            "value": 200
                        },
                        {
                            "label": "300 GB",
                            "value": 300
                        },
                        {
                            "label": "400 GB",
                            "value": 400
                        },
                        {
                            "label": "500 GB",
                            "value": 500
                        },
                        {
                            "label": "1000 GB",
                            "value": 1000
                        },
                        {
                            "label": "2000 GB",
                            "value": 2000
                        },
                        {
                            "label": "5000 GB",
                            "value": 5000
                        }
                    ],
                    "required": true
                },
                "visible": "[if(equals(basics('pricingTier'),'CapacityReservation'), true, false)]"
            }
          ],
          "steps": [
            {
              "name": "settings",
              "label": "Settings",
              "elements": [
                  {
                      "name": "infoBoxSettings",
                      "type": "Microsoft.Common.InfoBox",
                      "visible": true,
                      "options": {
                          "icon": "Info",
                          "text": "Please select which settings you would like to enable in your Microsoft Sentinel environment"
                      }
                  },
                  {
                      "name": "enableUeba",
                      "type": "Microsoft.Common.CheckBox",
                      "label": "Enable User Entity Behavior Analytics (UEBA)? Global Admin or Security Admin permission required.",
                "toolTip": "This will only enable synchronization with identity providers. Data sources need to be enabled separately. [Learn more](https://learn.microsoft.com/azure/sentinel/identify-threats-with-entity-behavior-analytics)",
                      "constraints": {
                          "required": false,
                          "validationMessage": "Please choose"
                      }
                  },
                  {
                      "name": "identityProviders",
                      "type": "Microsoft.Common.DropDown",
                      "label": "Select which Identity Providers will be synchronized with UEBA",
                      "placeholder": "Choose identity provider",
                      "multiselect": true,
                      "toolTip": "Select the identity providers that you would like to enable for UEBA",
                      "constraints": {
                          "allowedValues": [
                              {
                                  "label": "Azure Active Directory",
                                  "value": "AzureActiveDirectory"
                              },
                              {
                                  "label": "Active Directory (requires Microsoft Defender for Identity)",
                                  "value": "ActiveDirectory"
                              }
                          ],
                          "required": false
                      },
                      "visible": "[if(steps('settings').enableUeba, true, false)]"
                  },
                  {
                      "name": "enableDiagnostics",
                      "type": "Microsoft.Common.CheckBox",
                      "label": "Enable Sentinel health diagnostics?",
                      "toolTip": "This will enable diagnostics settings for Analytics rules, Data Connectors and Automation rules. [Learn more](https://learn.microsoft.com/azure/sentinel/health-audit)",
                      "constraints": {
                          "required": false,
                          "validationMessage": "Please select"
                      },
                      "visible": true
                  }
              ]
          },
          {
              "name": "solutions",
              "label": "Content Hub Solutions",
              "elements": [
                  {
                      "name": "infoBox1",
                      "type": "Microsoft.Common.InfoBox",
                      "visible": true,
                      "options": {
                          "icon": "Info",
                          "text": "Please select which Solutions you want to install into your Microsoft Sentinel environment. Solutions may contain different content types, like data connectors, analytics rules, parsers, workbooks, playbooks, hunting queries, etc.",
                          "uri": "https://learn.microsoft.com/azure/sentinel/sentinel-solutions-catalog"
                      }
                  },
                  {
                      "name": "enableSolutions1P",
                      "type": "Microsoft.Common.DropDown",
                      "label": "Select Microsoft Content Hub solutions to install",
                      "placeholder": "",
                      "multiselect": true,
                      "filter": true,
                      "filterPlaceholder": "Filter items ...",
                      "multiLine": true,
                      "defaultDescription": "A value for selection",
                      "toolTip": "Select the Microsoft solutions that you would like to install",
                      "constraints": {
                          "allowedValues": [
                              {
                                  "label": "Azure Active Directory",
                                  "description": "The Azure Active Directory solution for Microsoft Sentinel enables you to ingest Azure Active Directory Audit,Sign-in,Provisioning,Risk Events and Risky User/Service Principal logs using Diagnostic Settings into Microsoft Sentinel.",
                                  "value": "Azure Active Directory"
                              },
                              {
                                  "label": "Azure Activity",
                                  "description": "The Azure Activity solution for Microsoft Sentinel enables you to ingest Azure Activity Administrative, Security, Service Health, Alert, Recommendation, Policy, Autoscale and Resource Health logs using Diagnostic Settings into Microsoft Sentinel.",
                                  "value": "Azure Activity"
                              },
                              {
                                  "label": "Dynamics 365 CE",
                                  "description": "The Microsoft Sentinel solution for Dynamics 365 CE apps provides threat monitoring, detection and incident response capabilities for Dynamics 365 CE apps.",
                                  "value": "Dynamics 365 CE Apps"
                              },
                              {
                                  "label": "Microsoft 365",
                                  "description": "The Microsoft 365 solution for Microsoft Sentinel enables you to ingest operational logs from Microsoft 365 to gain insights into user and admin activity across your collaboration platforms such as Teams, SharePoint and Exchange.",
                                  "value": "Microsoft 365"
                              },
                              {
                                  "label": "Microsoft Defender for Cloud",
                                  "description": "The Microsoft Defender for Cloud solution for Microsoft Sentinel allows you to ingest Security alerts reported in Microsoft Defender for Cloud on assessing your hybrid cloud workload's security posture.",
                                  "value": "Microsoft Defender for Cloud"
                              },
                              {
                                  "label": "Microsoft Defender for Endpoint",
                                  "description": "Microsoft Defender for Endpoint is an enterprise endpoint security platform designed to help enterprise networks prevent, detect, investigate, and respond to advanced threats.",
                                  "value": "Microsoft Defender for Endpoint"
                              },
                              {
                                  "label": "Microsoft Defender for IoT",
                                  "description": "The Microsoft Defender for IoT solution for Microsoft Sentinel allows you to ingest Security alerts reported in Microsoft Defender for IoT on assessing your Internet of Things (IoT)/Operational Technology (OT) infrastructure.",
                                  "value": "Microsoft Defender for IoT"
                              },
                              {
                                  "label": "Microsoft Insider Risk Management",
                                  "description": "This solution enables insider risk management teams to investigate risk-based behavior across 25+ Microsoft products. This solution is a better-together story between Microsoft Sentinel and Microsoft Purview Insider Risk Management.",
                                  "value": "Microsoft Purview Insider Risk Management"
                              },
                              {
                                  "label": "Microsoft PowerBI",
                                  "description": "The Microsoft PowerBI solution enables you to track user activities in your PowerBI environment.",
                                  "value": "Microsoft PowerBI"
                              },
                              {
                                  "label": "Microsoft Project",
                                  "description": "Stream your Microsoft Project audit logs into Microsoft Sentinel in order to track your project activities.",
                                  "value": "Microsoft Project"
                              },
                              {
                                  "label": "Microsoft Teams",
                                  "description": "Microsoft Sentinel for Teams provides Teams security logs visibility and threat protection.",
                                  "value": "Teams"
                              },
                              {
                                  "label": "Threat Intelligence",
                                  "description": "Ingest threat indicators into Microsoft Sentinel. Threat indicators can be IP addresses, domains, URLs and file hashes and can be used to correlate across log sources for known indicators of compromise and/or indicators of active attack",
                                  "value": "Threat Intelligence"
                              }
                          ],
                          "required": false
                      },
                      "visible": true
                  },
                  {
                    "name": "enableSolutionsEssentials",
                      "type": "Microsoft.Common.DropDown",
                      "label": "Select Essentials Content Hub solutions to install",
                      "placeholder": "",
                      "multiselect": true,
                      "filter": true,
                      "filterPlaceholder": "Filter items ...",
                      "multiLine": true,
                      "defaultDescription": "A value for selection",
                      "toolTip": "Select essentials solutions that you would like to install",
                      "constraints": {
                          "allowedValues": [
                            {
                                "label": "Attacker Tools Threat Protection Essentials",
                                "description": "The Attacker Tools Threat Protection Essentials solution contains security content that is relevant for detection of tools commonly used by attackers in various campaigns",
                                "value": "Attacker Tools Threat Protection Essentials"
                            },
                            {
                                "label": "Cloud Identity Threat Protection Essentials",
                                "description": "The Cloud Identity Threat Protection Essentials solution looks for most common cloud focused identity attacks such as Suspicious Sign-ins, privilege grants, MFA disable etc.",
                                "value": "Cloud Identity Threat Protection Essentials"
                            },
                            {
                                "label": "Cloud Service Threat Protection Essentials",
                                "description": "The Cloud Service Threat Protection Essentials contains security content that is relevant for detection of attacks against various cloud services like key vault, storage, compute etc.",
                                "value": "Cloud Service Threat Protection Essentials"
                            },
                            {
                                "label": "Endpoint Threat Protection Essentials",
                                "description": "The Endpoint Threat Protection Essentials solution provides content to monitor, detect and investigate threats related to windows machines.",
                                "value": "Endpoint Threat Protection Essentials"
                            },
                            {
                                "label": "Network Session Essentials",
                                "description": "The Network Session Essentials solution leverages the Advanced Security Information Model (ASIM) to correlate insights across 15+ networking data sources and deliver more value for SOC use cases with less content.",
                                "value": "Network Session Essentials"
                            }, 
                            {
                                "label": "Network Threat Protection Essentials",
                                "description": "The Network Threat Protection Essentials solution contains queries that identifies suspicious network behavior based on various data sources ingested in Sentinel.",
                                "value": "Network Threat Protection Essentials"
                            },
                            {
                                "label": "SOC Handbook",
                                "description": "The SOC Handbook solution for Microsoft Sentinel provides a collection of resources that enable and empower SOC Analysts to get better visibility and understanding of point-in-time security posture of organizational resources.",
                                "value": "SOC Handbook"
                            },
                            {
                                "label": "SOC Process Framework",
                                "description": "The SOC Process Framework Solution is built in order to easily integrate with Microsoft Sentinel and build a standard SOC Process and Procedure Framework within your Organization.",
                                "value": "SOC Process Framework"
                            },
                            {
                                "label": "UEBA Essentials",
                                "description": "The Sentinel UEBA content package will provide you with various queries based on UEBA tables, that allows you to hunt for tailored threat scenarios.",
                                "value": "UEBA Essentials"
                            },
                            {
                                "label": "Users searching for VIP user activity",
                                "description": "The Users searching for VIP user activity solution helps detect and investigate suspicious search activity performed by VIP users.",
                                "value": "Users searching for VIP user activity"
                            },
                            {
                                "label": "Azure activity",
                                "description": "The Azure activity solution provides insights into the activity logs of your Azure resources.",
                                "value": "Azure activity"
                            },
                            {
                                "label": "Microsoft Defender for Cloud",
                                "description": "The Microsoft Defender for Cloud solution helps protect your cloud resources from threats and provides advanced threat detection and response capabilities.",
                                "value": "Microsoft Defender for Cloud"
                            },
                            {
                                "label": "Microsoft Defender XDR",
                                "description": "The Microsoft Defender XDR solution provides extended detection and response capabilities to help protect your organization against advanced threats.",
                                "value": "Microsoft Defender XDR"
                            },
                            {
                                "label": "Microsoft Entra ID",
                                "description": "The Microsoft Entra ID solution provides identity and access management capabilities to help secure your organization's resources.",
                                "value": "Microsoft Entra ID"
                            },
                            {
                                "label": "Security Threat Essentials",
                                "description": "The Security Threat Essentials solution contains security content that is relevant for detection and response to various threats.",
                                "value": "Security Threat Essentials"
                            },
                            {
                                "label": "Sentinel SOAR Essentials",
                                "description": "The Sentinel SOAR Essentials solution provides security orchestration, automation, and response capabilities to help streamline your security operations.",
                                "value": "Sentinel SOAR Essentials"
                            },
                            {
                                "label": "SOC Handbook",
                                "description": "The SOC Handbook solution for Microsoft Sentinel provides a collection of resources that enable and empower SOC Analysts to get better visibility and understanding of point-in-time security posture of organizational resources.",
                                "value": "SOC Handbook"
                            },
                            {
                                "label": "Threat Intelligence",
                                "description": "The Threat Intelligence solution provides insights and information about potential threats and vulnerabilities.",
                                "value": "Threat Intelligence"
                            },
                            {
                                "label": "UEBA Essentials",
                                "description": "The UEBA Essentials solution provides queries and analytics for User and Entity Behavior Analytics.",
                                "value": "UEBA Essentials"
                            },
                            {
                                "label": "VirusTotal",
                                "description": "The VirusTotal solution integrates with the VirusTotal service to provide information about file and URL reputation.",
                                "value": "VirusTotal"
                            },
                            {
                                "label": "Analytics Health & Audit",
                                "description": "The Analytics Health & Audit solution provides monitoring and auditing capabilities for your analytics workspaces.",
                                "value": "Analytics Health & Audit"
                            },
                            {
                                "label": "Workspace usage report",
                                "description": "The Workspace usage report solution generates a report on the usage of your workspaces.",
                                "value": "Workspace usage report"
                            },
                            {
                                "label": "AbuseIPDB",
                                "description": "The AbuseIPDB solution helps identify and block IP addresses associated with abusive activities.",
                                "value": "AbuseIPDB"
                            },
                            {
                                "label": "Attacker Tools Threat Protection Essentials",
                                "description": "The Attacker Tools Threat Protection Essentials solution contains security content that is relevant for detection of tools commonly used by attackers in various campaigns",
                                "value": "Attacker Tools Threat Protection Essentials"
                            },
                            {
                                "label": "Australian Cyber Security Centre",
                                "description": "The Australian Cyber Security Centre solution provides security content and resources specific to the Australian cybersecurity landscape.",
                                "value": "Australian Cyber Security Centre"
                            },
                            {
                                "label": "Azure Key Vault",
                                "description": "The Azure Key Vault solution provides security and management capabilities for your Azure key vaults.",
                                "value": "Azure Key Vault"
                            },
                            {
                                "label": "Azure Security Benchmark",
                                "description": "The Azure Security Benchmark solution helps you assess and improve the security of your Azure resources based on industry best practices.",
                                "value": "Azure Security Benchmark"
                            },
                            {
                                "label": "Business Email compromise - Financial fraud",
                                "description": "The Business Email compromise - Financial fraud solution provides detection and response capabilities for business email compromise and financial fraud incidents.",
                                "value": "Business Email compromise - Financial fraud"
                            },
                            {
                                "label": "Cloud Identity threat protection essentials",
                                "description": "The Cloud Identity threat protection essentials solution looks for most common cloud focused identity attacks such as Suspicious Sign-ins, privilege grants, MFA disable etc.",
                                "value": "Cloud Identity threat protection essentials"
                            },
                            {
                                "label": "Continuous Diagnostics& Mitigation",
                                "description": "The Continuous Diagnostics& Mitigation solution provides continuous monitoring and mitigation capabilities for your IT infrastructure.",
                                "value": "Continuous Diagnostics& Mitigation"
                            },
                            {
                                "label": "Endpoint threat protection essentials",
                                "description": "The Endpoint threat protection essentials solution provides content to monitor, detect and investigate threats related to windows machines.",
                                "value": "Endpoint threat protection essentials"
                            },
                            {
                                "label": "Malware protection essentials",
                                "description": "The Malware protection essentials solution provides protection against malware and helps detect and respond to malware-related incidents.",
                                "value": "Malware protection essentials"
                            },
                            {
                                "label": "Microsoft 365",
                                "description": "The Microsoft 365 solution provides security and management capabilities for your Microsoft 365 environment.",
                                "value": "Microsoft 365"
                            },
                            {
                                "label": "Microsoft Defender for Cloud Apps",
                                "description": "The Microsoft Defender for Cloud Apps solution provides advanced threat protection for your cloud applications.",
                                "value": "Microsoft Defender for Cloud Apps"
                            },
                            {
                                "label": "Microsoft Defender for Endpoint",
                                "description": "The Microsoft Defender for Endpoint solution provides advanced threat protection for your endpoints.",
                                "value": "Microsoft Defender for Endpoint"
                            },
                            {
                                "label": "Microsoft Defender for Office 365",
                                "description": "The Microsoft Defender for Office 365 solution provides advanced threat protection for your Office 365 environment.",
                                "value": "Microsoft Defender for Office 365"
                            },
                            {
                                "label": "Microsoft Defender Threat Intelligence",
                                "description": "The Microsoft Defender Threat Intelligence solution provides threat intelligence and insights for your security operations.",
                                "value": "Microsoft Defender Threat Intelligence"
                            },
                            {
                                "label": "Microsoft Entra ID Protection",
                                "description": "The Microsoft Entra ID Protection solution provides identity and access management capabilities to help secure your organization's resources.",
                                "value": "Microsoft Entra ID Protection"
                            },
                            {
                                "label": "Microsoft Exchange security for Exchange Online",
                                "description": "The Microsoft Exchange security for Exchange Online solution provides security capabilities for your Exchange Online environment.",
                                "value": "Microsoft Exchange security for Exchange Online"
                            },
                            {
                                "label": "Microsoft Purview",
                                "description": "The Microsoft Purview solution provides data discovery and classification capabilities for your organization's data.",
                                "value": "Microsoft Purview"
                            },
                            {
                                "label": "Microsoft Purview Information Protection",
                                "description": "The Microsoft Purview Information Protection solution provides data protection and governance capabilities for your organization's data.",
                                "value": "Microsoft Purview Information Protection"
                            },
                            {
                                "label": "Cloud Service Threat Protection Essentials",
                                "description": "The Cloud Service Threat Protection Essentials contains security content that is relevant for detection of attacks against various cloud services like key vault, storage, compute etc.",
                                "value": "Cloud Service Threat Protection Essentials"
                            },
                            {
                                "label": "Shodan",
                                "description": "The Shodan solution provides insights and information about internet-connected devices and services.",
                                "value": "Shodan"
                            },
                            {
                                "label": "Teams",
                                "description": "The Teams solution provides security and compliance capabilities for your Microsoft Teams environment.",
                                "value": "Teams"
                            },
                            {
                                "label": "URLHaus",
                                "description": "The URLHaus solution provides information about malicious URLs and helps protect against web-based threats.",
                                "value": "URLHaus"
                            },
                            {
                                "label": "Watchlist utilities",
                                "description": "The Watchlist utilities solution provides capabilities to manage and monitor watchlists of entities and indicators.",
                                "value": "Watchlist utilities"
                            },
                            {
                                "label": "Insecure Protocols",
                                "description": "The Insecure Protocols solution helps identify and remediate insecure protocols used in your network.",
                                "value": "Insecure Protocols"
                            },
                            {
                                "label": "Sentinel Costs",
                                "description": "The Sentinel Costs solution provides insights and reports on the costs associated with your Azure Sentinel deployment.",
                                "value": "Sentinel Costs"
                            },
                            {
                                "label": "Sentinel Health",
                                "description": "The Sentinel Health solution provides monitoring and health assessment capabilities for your Azure Sentinel deployment.",
                                "value": "Sentinel Health"
                            },
                            {
                                "label": "User and Entity behavior Analytics",
                                "description": "The User and Entity behavior Analytics solution provides advanced analytics and insights into user and entity behavior.",
                                "value": "User and Entity behavior Analytics"
                            },
                            {
                                "label": "A client made a web request to a potentially harmful file (ASIM Web Session schema)",
                                "description": "The A client made a web request to a potentially harmful file (ASIM Web Session schema) solution provides detection and response capabilities for web-based threats.",
                                "value": "A client made a web request to a potentially harmful file (ASIM Web Session schema)"
                            },
                            {
                                "label": "A host is potentially running a hacking tool (ASIM Web Session schema)",
                                "description": "The A host is potentially running a hacking tool (ASIM Web Session schema) solution provides detection and response capabilities for potential hacking activities.",
                                "value": "A host is potentially running a hacking tool (ASIM Web Session schema)"
                            },
                            {
                                "label": "A host is potentially running PowerShell to send HTTP(S) requests (ASIM Web Session schema)",
                                "description": "The A host is potentially running PowerShell to send HTTP(S) requests (ASIM Web Session schema) solution provides detection and response capabilities for PowerShell-based attacks.",
                                "value": "A host is potentially running PowerShell to send HTTP(S) requests (ASIM Web Session schema)"
                            },
                            {
                                "label": "Account created from non-approved sources",
                                "description": "The Account created from non-approved sources solution provides detection and response capabilities for unauthorized account creations.",
                                "value": "Account created from non-approved sources"
                            },
                            {
                                "label": "ACSC Essential 8",
                                "description": "The ACSC Essential 8 solution provides security content and resources based on the Australian Cyber Security Centre's Essential 8 strategies.",
                                "value": "ACSC Essential 8"
                            },
                            {
                                "label": "Add IP Entity To Named Location",
                                "description": "The Add IP Entity To Named Location solution provides capabilities to add IP entities to named locations for better visibility and management.",
                                "value": "Add IP Entity To Named Location"
                            },
                            {
                                "label": "Addition of a Temporary Access Pass to a Privileged Account",
                                "description": "The Addition of a Temporary Access Pass to a Privileged Account solution provides detection and response capabilities for temporary access pass additions to privileged accounts.",
                                "value": "Addition of a Temporary Access Pass to a Privileged Account"
                            },
                            {
                                "label": "Anomalous login followed by Teams action",
                                "description": "The Anomalous login followed by Teams action solution provides detection and response capabilities for anomalous logins followed by Teams actions.",
                                "value": "Anomalous login followed by Teams action"
                            },
                            {
                                "label": "Anomalous Single Factor Signin",
                                "description": "The Anomalous Single Factor Signin solution provides detection and response capabilities for anomalous single factor sign-ins.",
                                "value": "Anomalous Single Factor Signin"
                            },
                            {
                                "label": "Anomalous User Agent connection attempt",
                                "description": "The Anomalous User Agent connection attempt solution provides detection and response capabilities for anomalous user agent connection attempts.",
                                "value": "Anomalous User Agent connection attempt"
                            },
                            {
                                "label": "Anomaly Sign In Event from an IP",
                                "description": "The Anomaly Sign In Event from an IP solution provides detection and response capabilities for anomalous sign-in events from specific IP addresses.",
                                "value": "Anomaly Sign In Event from an IP"
                            },
                            {
                                "label": "Application ID URI Changed",
                                "description": "The Application ID URI Changed solution provides detection and response capabilities for changes to application ID URIs.",
                                "value": "Application ID URI Changed"
                            },
                            {
                                "label": "Application Redirect URL Update",
                                "description": "The Application Redirect URL Update solution provides detection and response capabilities for updates to application redirect URLs.",
                                "value": "Application Redirect URL Update"
                            },
                            {
                                "label": "Archiving, Basic Logs, and Retention",
                                "description": "The Archiving, Basic Logs, and Retention solution provides capabilities for archiving, managing basic logs, and retention of data.",
                                "value": "Archiving, Basic Logs, and Retention"
                            },
                            {
                                "label": "ASC Compliance and Protection",
                                "description": "The ASC Compliance and Protection solution provides compliance and protection capabilities for your Azure Security Center environment.",
                                "value": "ASC Compliance and Protection"
                            },
                            {
                                "label": "Audit policy manipulation using auditpol utility",
                                "description": "The Audit policy manipulation using auditpol utility solution provides detection and response capabilities for audit policy manipulations using the auditpol utility.",
                                "value": "Audit policy manipulation using auditpol utility"
                            },
                            {
                                "label": "Authentication Attempt from New Country",
                                "description": "The Authentication Attempt from New Country solution provides detection and response capabilities for authentication attempts from new countries.",
                                "value": "Authentication Attempt from New Country"
                            },
                            {
                                "label": "Authentications of Privileged Accounts Outside of Expected Controls",
                                "description": "The Authentications of Privileged Accounts Outside of Expected Controls solution provides detection and response capabilities for authentications of privileged accounts outside of expected controls.",
                                "value": "Authentications of Privileged Accounts Outside of Expected Controls"
                            },
                            {
                                "label": "Azure AD Audit, Activity and Sign-in logs",
                                "description": "The Azure AD Audit, Activity and Sign-in logs solution provides monitoring and auditing capabilities for your Azure AD environment.",
                                "value": "Azure AD Audit, Activity and Sign-in logs"
                            },
                            {
                                "label": "Azure CloudShell Usage",
                                "description": "The Azure CloudShell Usage solution provides monitoring and auditing capabilities for your Azure CloudShell usage.",
                                "value": "Azure CloudShell Usage"
                            },
                            {
                                "label": "Azure Log Coverage",
                                "description": "The Azure Log Coverage solution provides insights and reports on the log coverage of your Azure resources.",
                                "value": "Azure Log Coverage"
                            },
                            {
                                "label": "Brute force attack against user credentials (Uses Authentication Normalization)",
                                "description": "The Brute force attack against user credentials (Uses Authentication Normalization) solution provides detection and response capabilities for brute force attacks against user credentials.",
                                "value": "Brute force attack against user credentials (Uses Authentication Normalization)"
                            },
                            {
                                "label": "Changes to Application Logout URL",
                                "description": "The Changes to Application Logout URL solution provides detection and response capabilities for changes to application logout URLs.",
                                "value": "Changes to Application Logout URL"
                            },
                            {
                                "label": "Changes to Application Ownership",
                                "description": "The Changes to Application Ownership solution provides detection and response capabilities for changes to application ownership.",
                                "value": "Changes to Application Ownership"
                            },
                            {
                                "label": "Changes to PIM Settings",
                                "description": "The Changes to PIM Settings solution provides detection and response capabilities for changes to Privileged Identity Management (PIM) settings.",
                                "value": "Changes to PIM Settings"
                            },
                            {
                                "label": "Conditional Access Trends and Changes",
                                "description": "The Conditional Access Trends and Changes solution provides insights and reports on the trends and changes in your conditional access policies.",
                                "value": "Conditional Access Trends and Changes"
                            },
                            {
                                "label": "Data collection health monitoring",
                                "description": "The Data collection health monitoring solution provides monitoring and health assessment capabilities for your data collection processes.",
                                "value": "Data collection health monitoring"
                            },
                            {
                                "label": "Data Security - Sensitive Data Impact Assessment",
                                "description": "The Data Security - Sensitive Data Impact Assessment solution provides capabilities to assess the impact of sensitive data exposures.",
                                "value": "Data Security - Sensitive Data Impact Assessment"
                            },
                            {
                                "label": "Detect PIM Alert Disabling activity",
                                "description": "The Detect PIM Alert Disabling activity solution provides detection and response capabilities for PIM alert disabling activities.",
                                "value": "Detect PIM Alert Disabling activity"
                            },
                            {
                                "label": "Detecting Impossible travel with mailbox permission tampering & Privilege Escalation attempt",
                                "description": "The Detecting Impossible travel with mailbox permission tampering & Privilege Escalation attempt solution provides detection and response capabilities for impossible travel with mailbox permission tampering and privilege escalation attempts.",
                                "value": "Detecting Impossible travel with mailbox permission tampering & Privilege Escalation attempt"
                            },
                            {
                                "label": "Email access via active sync",
                                "description": "The Email access via active sync solution provides detection and response capabilities for email access via ActiveSync.",
                                "value": "Email access via active sync"
                            },
                            {
                                "label": "End-user consent stopped due to risk-based consent",
                                "description": "The End-user consent stopped due to risk-based consent solution provides detection and response capabilities for end-user consent being stopped due to risk-based consent.",
                                "value": "End-user consent stopped due to risk-based consent"
                            },
                            {
                                "label": "External User Access Enabled",
                                "description": "The External User Access Enabled solution provides detection and response capabilities for enabling external user access.",
                                "value": "External User Access Enabled"
                            },
                            {
                                "label": "Failed Login Attempt by Expired account",
                                "description": "The Failed Login Attempt by Expired account solution provides detection and response capabilities for failed login attempts by expired accounts.",
                                "value": "Failed Login Attempt by Expired account"
                            },
                            {
                                "label": "Fake computer account created",
                                "description": "The Fake computer account created solution provides detection and response capabilities for fake computer account creations.",
                                "value": "Fake computer account created"
                            },
                            {
                                "label": "Group created then added to built in domain local or global group",
                                "description": "The Group created then added to built in domain local or global group solution provides detection and response capabilities for group creations followed by additions to built-in domain local or global groups.",
                                "value": "Group created then added to built in domain local or global group"
                            },
                            {
                                "label": "Guest Users Invited to Tenant by New Inviters",
                                "description": "The Guest Users Invited to Tenant by New Inviters solution provides detection and response capabilities for guest users being invited to the tenant by new inviters.",
                                "value": "Guest Users Invited to Tenant by New Inviters"
                            },
                            {
                                "label": "High count of connections by client IP on many ports",
                                "description": "The High count of connections by client IP on many ports solution provides detection and response capabilities for high counts of connections by client IP on multiple ports.",
                                "value": "High count of connections by client IP on many ports"
                            },
                            {
                                "label": "High count of failed attempts from same client IP",
                                "description": "The High count of failed attempts from same client IP solution provides detection and response capabilities for high counts of failed attempts from the same client IP.",
                                "value": "High count of failed attempts from same client IP"
                            },
                            {
                                "label": "High count of failed logons by a user",
                                "description": "The High count of failed logons by a user solution provides detection and response capabilities for high counts of failed logons by a user.",
                                "value": "High count of failed logons by a user"
                            },
                            {
                                "label": "High Number of Urgent Vulnerabilities Detected",
                                "description": "The High Number of Urgent Vulnerabilities Detected solution provides detection and response capabilities for high numbers of urgent vulnerabilities detected.",
                                "value": "High Number of Urgent Vulnerabilities Detected"
                            },
                            {
                                "label": "High risk Office operation conducted by IP Address that recently attempted to log into a disabled account",
                                "description": "The High risk Office operation conducted by IP Address that recently attempted to log into a disabled account solution provides detection and response capabilities for high-risk Office operations conducted by IP addresses that recently attempted to log into a disabled account.",
                                "value": "High risk Office operation conducted by IP Address that recently attempted to log into a disabled account"
                            }
                          ],
                          "required": false
                      },
                      "visible": true
                  },
                  {
                    "name": "enableSolutionsTraining",
                      "type": "Microsoft.Common.DropDown",
                      "label": "Select Training and Tutorials Content Hub solutions to install",
                      "placeholder": "",
                      "multiselect": true,
                      "filter": true,
                      "filterPlaceholder": "Filter items ...",
                      "multiLine": true,
                      "defaultDescription": "A value for selection",
                      "toolTip": "Select the training and tutorials solutions that you would like to install",
                      "constraints": {
                          "allowedValues": [
                            {
                                "label": "KQL Training",
                                "description": "The KQL Training solution for Microsoft Sentinel contains resources that can help up – skill on understanding the fundamentals and using KQL in advanced scenarios like authoring effective and optimized queries used in Sentinel Analytics, Hunting Queries, Workbooks, etc.",
                                "value": "KQL Training"
                            },
                            {
                                "label": "Training Lab",
                                "description": "Microsoft Sentinel Training Lab helps you get ramped up with Microsoft Sentinel providing hands-on practical experience for product features, capabilities, and scenarios.",
                                "value": "Microsoft Sentinel Training Lab"
                            }
                          ],
                          "required": false
                      },
                      "visible": true
                  }
              ]
          },
          {
              "name": "dataConnectors",
              "label": "Data connectors",
              "elements": [
                  {
                      "name": "infoBoxConnectors",
                      "type": "Microsoft.Common.InfoBox",
                      "visible": true,
                      "options": {
                          "icon": "Info",
                          "text": "Please select which Data Connectors you would like to configure in your Microsoft Sentinel environment",
                          "uri": "https://learn.microsoft.com/azure/sentinel/data-connectors-reference"
                      }
                  },
                  {
                      "name": "enableDataConnectors",
                      "type": "Microsoft.Common.DropDown",
                      "label": "Select data connectors to onboard",
                      "placeholder": "",
                      "multiselect": true,
                      "filter": true,
                      "filterPlaceholder": "Filter items ...",
                      "multiLine": true,
                      "defaultDescription": "A value for selection",
                      "toolTip": "Select the data connectors that you would like to enable",
                      "constraints": {
                          "allowedValues": [
                            {
                                "label": "Azure Active Directory",
                                "description": "Relevant license and Global Admin or Security Admin permission required.",
                                "value": "AzureActiveDirectory"
                            },  
                            {
                                "label": "Azure Active Directory Identity Protection",
                                "description": "Relevant license and Global Admin or Security Admin permission required.",
                                "value": "AzureActiveDirectoryIDP"
                            },
                            {
                                "label": "Azure Activity",
                                "description": "This will only bring logs from the subscription selected in Basics tab. Relevant permissions at the subscription level are required.",
                                "value": "AzureActivity"
                            },
                            {
                                "label": "Microsoft 365 Defender",
                                "description": "This will only enable incident and alert synchronization, no advanced hunting data will be enabled. Relevant license and Global Admin or Security Admin permission required",
                                "value": "Microsoft365Defender"
                            },
                            {
                                "label": "Microsoft Defender for Cloud",
                                "description": "Security Reader permission required",
                                "value": "MicrosoftDefenderForCloud"
                            },
                            {
                                "label": "Microsoft Insider Risk Management",
                                "description": "Relevant license and Global Admin or Security Admin permission required",
                                "value": "OfficeIRM"
                            },
                            {
                                "label": "Microsoft PowerBI",
                                "description": "Relevant license and Global Admin or Security Admin permission required",
                                "value": "OfficePowerBI"
                            },
                            {
                                "label": "Microsoft Project",
                                "description": "Relevant license and Global Admin or Security Admin permission required",
                                "value": "Office365Project"
                            },
                            {
                                "label": "Office 365",
                                "description": "Relevant license and Global Admin or Security Admin permission required",
                                "value": "Office365"
                            },
                            {
                                "label": "Threat Intelligence Platforms",
                                "description": "Global Admin or Security Admin permission required",
                                "value": "ThreatIntelligence"
                            }
                          ],
                          "required": true
                      },
                      "visible": true
                  },
                  {
                    "name": "aadStreams",
                      "type": "Microsoft.Common.DropDown",
                      "label": "Select Azure Active Directory log types to enable",
                      "placeholder": "",
                      "multiselect": true,
                      "defaultValue": [{"value": "SignInLogs"}, {"value": "AuditLogs"}],
                      "toolTip": "Select Azure Active Directory log types you would like to stream to the workspace",
                      "constraints": {
                          "allowedValues": [
                              {
                                  "label": "Signin Logs",
                                  "value": "SignInLogs"
                              },
                              {
                                  "label": "Audit Logs",
                                  "value": "AuditLogs"
                              },
                              {
                                  "label": "Non-Interactive User Sign-In Log (Preview)",
                                  "value": "NonInteractiveUserSignInLogs"
                              },
                              {
                                  "label": "Service Principal Sign-In Logs (Preview)",
                                  "value": "ServicePrincipalSignInLogs"
                              },
                              {
                                  "label": "Managed Identity Sign-In Logs (Preview)",
                                  "value": "ManagedIdentitySignInLogs"
                              },
                              {
                                  "label": "Provisioning Logs (Preview)",
                                  "value": "ProvisioningLogs"
                              },
                              {
                                  "label": "ADFS Sign-In Logs (Preview)",
                                  "value": "ADFSSignInLogs"
                              },
                              {
                                  "label": "User Risk Events (Preview)",
                                  "value": "UserRiskEvents"
                              },
                              {
                                  "label": "Risky Users (Preview)",
                                  "value": "RiskyUsers"
                              },
                              {
                                  "label": "Network Access Traffic Logs (Preview)",
                                  "value": "NetworkAccessTrafficLogs"
                              },
                              {
                                  "label": "Risky Service Principals (Preview)",
                                  "value": "RiskyServicePrincipals"
                              },
                              {
                                  "label": "Service Principal Risk Events (Preview)",
                                  "value": "ServicePrincipalRiskEvents"
                              }
                          ],
                          "required": false
                      },
                      "visible": "[if(contains(steps('dataConnectors').enableDataConnectors,'AzureActiveDirectory'),true,false)]"
                  }
              ]
          },
          {
              "name": "analyticsRules",
              "label": "Analytics Rules",
              "elements": [
                  {
                      "name": "infoBoxRules",
                      "type": "Microsoft.Common.InfoBox",
                      "visible": true,
                      "options": {
                          "icon": "Info",
                          "text": "Please select which analytics rules you would like to enable in your Microsoft Sentinel environment",
                          "uri": "https://learn.microsoft.com/azure/sentinel/detect-threats-built-in"
                      }
                  },
                  {
                      "name": "enableMLAlerts",
                      "type": "Microsoft.Common.CheckBox",
                      "label": "Enable ML Behavior Analytics alert rules?",
                      "toolTip": "Select to enable ML Behavior Analytics rules for selected connectors (SecurityEvents and/or Syslog)",
                      "constraints": {
                          "required": false,
                          "validationMessage": "Enables SSH and/or RDP anomalous login alerts"
                      },
                      "visible": "[if(or(contains(steps('dataConnectors').enableDataConnectors,'Syslog'),contains(steps('dataConnectors').enableDataConnectors,'SecurityEvents')), true, false)]"
                  },
                  {
                      "name": "enableScheduledAlerts",
                      "type": "Microsoft.Common.CheckBox",
                      "label": "Enable Scheduled alert rules for selected Content Hub solutions and Data Connectors?",
                      "toolTip": "Select to enable Scheduled and NRT analytics rules for the solutions and connectors selected in the previous tabs",
                      "constraints": {
                          "required": false,
                          "validationMessage": "Enables Scheduled and NRT rules matching any of the selected solutions and connectors"
                      },
                      "visible": true
                  },
                  {
                      "name": "severityLevels",
                      "type": "Microsoft.Common.DropDown",
                      "label": "Select the severity of the rules to enable",
                      "placeholder": "",
                      "multiselect": true,
                      "defaultValue": [{"value": "High"}, {"value": "Medium"}],
                      "toolTip": "Select the data connectors that you would like to enable",
                      "constraints": {
                          "allowedValues": [
                              {
                                  "label": "High",
                                  "value": "High"
                              },
                              {
                                  "label": "Medium",
                                  "value": "Medium"
                              },
                              {
                                  "label": "Low",
                                  "value": "Low"
                              },
                              {
                                  "label": "Informational",
                                  "value": "informational"
                              }
                          ],
                          "required": false
                      },
                      "visible": "[if(steps('analyticsRules').enableScheduledAlerts, true, false)]"
                  }
              ]
          }
        ],
        "outputs": {
            "workspaceName": "[basics('workspaceName')]",
            "dailyQuota": "[basics('dailyQuota')]",
            "dataRetention": "[basics('dataRetention')]",
            "pricingTier": "[basics('pricingTier')]",
            "capacityReservation": "[basics('capacityReservation')]",
            "enableUeba": "[steps('settings').enableUeba]",
            "identityProviders": "[steps('settings').identityProviders]",
            "enableDiagnostics": "[steps('settings').enableDiagnostics]",
            "enableSolutions1P": "[steps('solutions').enableSolutions1P]",
            "enableSolutionsEssentials": "[steps('solutions').enableSolutionsEssentials]",
            "enableSolutionsTraining": "[steps('solutions').enableSolutionsTraining]",
            "enableDataConnectors": "[steps('dataConnectors').enableDataConnectors]",
            "aadStreams": "[steps('dataConnectors').aadStreams]",
            "location": "[location()]",
            "enableMLAlerts": "[steps('analyticsRules').enableMLAlerts]",
            "enableScheduledAlerts": "[steps('analyticsRules').enableScheduledAlerts]",
            "severityLevels": "[steps('analyticsRules').severityLevels]",
            "rgName": "[basics('rgName')]"
        }
    }
}